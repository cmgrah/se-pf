Hardened GS108Ev3 Configuration

All VLANs Tagged • PVID = 999 • No Native VLAN

This configuration enforces:
- Zero untagged traffic
- Deterministic VLAN behaviour
- Hypervisors and management devices must tag VLANs
- Misconfigurations become immediately visible
- ASD‑aligned network hygiene

---

Port Roles (Confirmed)

| Port | Role                | Notes |
|------|---------------------|-------|
| 1    | CAM-DESK (Mgmt)     | Tags VLAN 10 |
| 2    | Unraid Hypervisor   | Pi-hole at 10.20.0.5 on VLAN 20 |
| 8    | Uplink to OPNsense  | Carries all VLANs |

---

VLAN Membership Table (Hardened)

`
VLAN 1   (Home)        Port 1 T | Port 2 T | Port 8 T
VLAN 10  (Mgmt)        Port 1 T | Port 2 T | Port 8 T
VLAN 20  (Internal)    Port 1 T | Port 2 T | Port 8 T
VLAN 30  (DMZ)         Port 1 T | Port 2 T | Port 8 T
VLAN 40  (Clients)     Port 1 T | Port 2 T | Port 8 T
VLAN 50  (WiFi)        Port 1 T | Port 2 T | Port 8 T
VLAN 999 (Blackhole)   Port 1 U | Port 2 U | Port 8 U
`

- All real VLANs are tagged.
- VLAN 999 is the only untagged VLAN, intentionally unused.
- Any untagged ingress is dropped into VLAN 999.

---

PVID Table (Hardened)

`
Port 1 → PVID 999
Port 2 → PVID 999
Port 8 → PVID 999
`

This forces:
- CAM-DESK to tag VLAN 10
- Unraid to tag VLAN 10 (mgmt) and VLAN 20 (Pi-hole)
- OPNsense to tag all VLANs on uplink

---

Unraid Requirements

- Enable VLANs on br0
- Create br0.10 for Unraid GUI (10.10.0.10)
- Create br0.20 for Pi-hole (10.20.0.5)
- Pi-hole gateway: 10.20.0.1
- Unraid mgmt gateway: 10.10.0.1

If Unraid sends untagged traffic, it will fall into VLAN 999 and disappear.

---

OPNsense Requirements

VLAN Interfaces
- VLAN 10 → 10.10.0.1/24 (Mgmt)
- VLAN 20 → 10.20.0.1/24 (Internal)

Firewall Rules (Minimum)
On VLAN 10:
`
Allow VLAN10 net → any
`

On VLAN 20:
`
Allow VLAN20 net → any
`

(You can later restrict inter-VLAN access as needed.)

---

Connectivity Verification

From CAM-DESK:
`
ping 10.10.0.10   # Unraid GUI
ping 10.20.0.5    # Pi-hole
`

From OPNsense shell:
`
ping 10.10.0.10
ping 10.20.0.5
`

From Unraid:
`
ping 10.10.0.1    # OPNsense VLAN 10
ping 10.20.0.1    # OPNsense VLAN 20
`

If OPNsense can ping both but CAM-DESK cannot → firewall rules.
If OPNsense cannot ping → VLAN tagging issue on Unraid.

---

Key Guarantee

Yes — you will still be able to access Unraid’s GUI at 10.10.0.10.  
Because VLAN 10 is tagged end‑to‑end on Ports 1, 2, and 8, and both CAM-DESK and Unraid tag VLAN 10 correctly.

`

If you want, I can also generate:

- A matching hardened OPNsense trunk config  
- A diagram showing the full management and internal VLAN paths  
- A troubleshooting flowchart for your documentation  

Just say the word.